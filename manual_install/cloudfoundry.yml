--- 
name: cloudfoundry
version: 96.1-dev
director_uuid: BOSH_DIRECTOR_UUID

release:
    name: cloudfoundry
    version: 96.1-dev

compilation:
  workers: 2
  network: private
  cloud_properties:
    instance_type: m1.small
    key_name: deployer

update:
  canaries: 1
  canary_watch_time: 3000-90000
  update_watch_time: 3000-90000
  max_in_flight: 1
  max_errors: 1 

networks:
- name: private
  type: dynamic
  cloud_properties:
    security_groups:
    - default
- name: public 
  type: vip
  cloud_properties:
    security_groups:
       - default

resource_pools:
- name: dea
  network: private
  size: 4
  stemcell: 
    name: micro-bosh-stemcell
    version: 0.6.4
  cloud_properties: 
    instance_type: m1.small
    key_name: deployer
  env: 
    bosh:
      password: YOUR_SALTED_BOSH_PASSWORD
- name: infrastructure
  network: private
  size: 10
  stemcell: 
    name: micro-bosh-stemcell
    version: 0.6.4
  cloud_properties:
    instance_type: m1.small
    key_name: deployer
  env: 
    bosh:
      password: YOUR_SALTED_BOSH_PASSWORD

jobs:
- name: debian_nfs_server
  template: debian_nfs_server
  instances: 1
  resource_pool: infrastructure
  persistent_disk: 8192
  networks:
  - name: private
    default: 
    - dns
    - gateway
  - name: public
    static_ips: 
    - NFS_SERVER_IP_ADDRESS
- name: cloud_controller
  template: cloud_controller
  instances: 2
  resource_pool: infrastructure
  networks: 
  - name: private
    default: 
    - dns
    - gateway
- name: dea
  template: dea
  instances: 4
  resource_pool: dea
  networks: 
  - name: private
    default: 
    - dns
    - gateway
- name: router
  template: router
  instances: 1
  resource_pool: infrastructure
  networks: 
  - name: private
    default: 
    - dns
    - gateway
  - name: public
    static_ips: 
    - ROUTER_IP_ADDRESS
- name: stager
  template: stager
  instances: 1
  resource_pool: infrastructure
  networks: 
  - name: private
    default: 
    - dns
    - gateway
- name: ccdb_postgres
  template: ccdb_postgres
  instances: 1
  resource_pool: infrastructure
  persistent_disk: 8192
  networks: 
  - name: private
    default: 
    - dns
    - gateway
  - name: public
    static_ips: 
    - CLOUDCONTROLLER_IP_ADDRESS
- name: vcap_redis
  template: vcap_redis
  instances: 1
  resource_pool: infrastructure
  networks: 
  - name: private
    default: 
    - dns
    - gateway
  - name: public
    static_ips: 
    - REDIS_IP_ADDRESS
- name: health_manager
  template: health_manager
  instances: 1
  resource_pool: infrastructure
  networks: 
  - name: private
    default: 
    - dns
    - gateway
- name: nats
  template: nats
  instances: 1
  resource_pool: infrastructure
  networks: 
  - name: private
    default: 
    - dns
    - gateway


properties:
  domain: YOUR_CLOUDFOUNDRY_DOMAIN

  env: {}

  networks:
    apps: private
    management: private

  nats:
    user: nats
    password: nats
    address: YOUR_BOSH_HOST
    port: 4222

  cc:
    srv_api_uri: http://api.YOUR_CLOUDFOUNDRY_DOMAIN
    external_uri: YOUR_CLOUDFOUNDRY_DOMAIN
    password: aaauuLaap44jadlas2l312lk
    token: aaaf4eaa8c1758f66d5cb7adcb24adb9d7
    use_nginx: true
    new_stager_percent: 25
    new_stager_email_regexp: '.*@YOUR_EMAIL_DOMAIN'
    staging_upload_user: stager
    staging_upload_password: definitelychangeme
    allow_registration: true
    uaa:
      enabled: false
      resource_id: cloud_controller
      client_secret: aaaNxRJcx6cpv
    admins:
    - YOUR_EMAIL_ADDRESS

  stager:
    max_staging_duration: 120
    max_active_tasks: 20
    queues:
    - staging

  ccdb:
    user: ccadmin
    password: changemechangeme
    address: CLOUDCONTROLLER_IP_ADDRESS
    port: 5524
    pool_size: 10
    dbname: appcloud
    roles:
    - tag: admin
      name: ccadmin
      password: changemechangeme
    databases:
    - tag: cc
      name: appcloud

  vcap_redis:
    address: REDIS_IP_ADDRESS
    port: 5454
    password: changemechangemechangeme
    maxmemory: 1000000000 # 1GB

  dea:
    max_memory: 1024

  nfs_server:
    address: NFS_SERVER_IP_ADDRESS
    network: YOUR_PRIVATE_SUBNET_CIDR

  router:
    status:
      port: 8080
      user: router
      password: changemechangemechangeme

  uaa:
    cc:
      token_secret: aaabxaiC371JM
      client_secret: $2a$08$dahioBqSkqa1AbLvaqkLoe5W0aOPN3Ia9W0xkeB926G.AZJhq1SsK
    batch:
      username: do0H2AKay2jAc
      password: FSCTiplI5Q83n
